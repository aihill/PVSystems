<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>PVSystems.Examples.Application</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;More complete application examples&quot;">
<style type="text/css">
*       { font-size: 100%; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 90%; font-family: Courier, monospace; white-space: pre; } /* For the Modelica code (in exported html). */
h4      { font-size: 100%; font-weight: bold; color: green; } 
h3      { font-size: 110%; font-weight: bold; color: green; }
h2      { font-size: 130%; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { padding: 2px; border: 1px solid #808080; vertical-align: top; }
th      { padding: 2px; border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
pre, code {font-family: "Courier New", monospace;}
pre {white-space: pre; overflow-x : hidden;}
.ModelicaDescription {font-weight: bold;} /* For the description string of the class. */
.ModelicaBaseClass {} /* For the list of base-classes at the of the description. */
.ModelicaKeyword { color: blue; font-weight: normal; font-style: normal; } /* Keywords in Modelica. */
.ModelicaComment { color: #006400;  font-weight: normal; font-style: normal;} /* All three variants of comments in Modelica.  */
.ModelicaString { color: #006400;  font-weight: normal; font-style: normal;} /* String constants. */
.ModelicaClass { color: red; font-weight: normal; font-style: normal;} /* Formatting the names of referenced classes (for base-class and components). */
.ModelicaFunction { color: red; font-weight: normal; font-style: normal;} /* Formatting for called functions. */
.ModelicaTablePackageContent { } /* The table of contents for each package. */
.ModelicaTableCrossReference { } /* The optional cross-reference table. */
.ModelicaTableInputs {} /* The table of inputs for a function. */
.ModelicaTableOutputs {} /* The table of outputs for a function. */
.ModelicaTableParameters {} /* The table of parameters for a model/block. */
.ModelicaTableConnectors {} /* The table of connectors for a model/block. */
.ModelicaTableContents {} /* The table of contents for a connector. */
.ModelicaStartAttribute { font-weight: bold; } /* The formatting used for start-attribute in the table of parameters, to separate them from parameter values. */
.ModelicaParameterTab { background-color: #c0c0c0; font-weight: bold; } /* The tab-heading in the table of parameters */
.ModelicaParameterGroup { background-color: #e0e0e0; } /* The group-heading in the table of parameters */
</style>
</head>
<body>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Application<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="PVSystems.Examples.Application"></a><a href="PVSystems_Examples.html#PVSystems.Examples"
>PVSystems.Examples</a>.Application</h2>
<p>
<span class="ModelicaDescription">More complete application examples</span><br>
</p>
<h3>Information</h3>
<p><span class="ModelicaBaseClass">Extends from Modelica.Icons.ExamplesPackage (Icon for packages containing runnable examples).</span></p>
<h3>Package Content</h3>
<table summary="Package Content" class="ModelicaTablePackageContent">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.BuckOpen" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.BuckOpen"
>BuckOpen</a>
</td>
<td>Ideal open-loop buck converter</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.Inverter1phOpen" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.Inverter1phOpen"
>Inverter1phOpen</a>
</td>
<td>Stand-alone 1-phase open-loop inverter with constant DC source</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.Inverter1phOpenSynch" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.Inverter1phOpenSynch"
>Inverter1phOpenSynch</a>
</td>
<td>Grid-tied 1-phase open-loop inverter with constant DC source</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.Inverter1phClosed" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.Inverter1phClosed"
>Inverter1phClosed</a>
</td>
<td>Stand-alone 1-phase closed-loop inverter with constant DC source</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.Inverter1phClosedSynch" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.Inverter1phClosedSynch"
>Inverter1phClosedSynch</a>
</td>
<td>Grid-tied 1-phase closed-loop inverter with constant DC source</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.PVInverter1ph" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.PVInverter1ph"
>PVInverter1ph</a>
</td>
<td>Stand-alone 1-phase closed-loop inverter with PV source</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.PVInverter1phSynch" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.PVInverter1phSynch"
>PVInverter1phSynch</a>
</td>
<td>Grid-tied 1-phase closed-loop inverter with PV source</td>
</tr>
<tr>
<td><img src="PVSystems.Examples.Application.BuckOpenS.png" alt="PVSystems.Examples.Application.USBBatteryConverter" width="20" height="20" align="top">&nbsp;<a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.USBBatteryConverter"
>USBBatteryConverter</a>
</td>
<td>Bidirectional converter for USB battery interface</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE BuckOpen<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.BuckOpen" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.BuckOpen"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.BuckOpen</h2>
<p>
<span class="ModelicaDescription">Ideal open-loop buck converter</span>
<br>
<br><img src="PVSystems.Examples.Application.BuckOpenD.png" alt="PVSystems.Examples.Application.BuckOpen">
</p>
<h3>Information</h3>

        <p>
          This example compares two implementations of a buck
          DC-DC converter. The switched version is built using
          mostly blocks
          from <a  >Modelica's
          electrical library</a> but also includes
          the <a href="PVSystems_Control.html#PVSystems.Control.SwitchingPWM"
>SwitchingPWM</a>
          model. The averaged version is built around a
          replaceable instance of the average switch model for CCM
          (continuous conduction mode) and DCM (discontinuous
          conduction mode) considering no losses.
        </p>
      
        <p>
          This example showcases how components from PVSystems can
          be mixed with components from the Modelica Standard
          Library to build systems that might be of
          interest. Additionally, it aims validating the average
          switch model performance by comparison with the more
          accurate/detailed switched model.
        </p>
      
        <p>
          This is still an open-loop system. A duty cycle value is
          fed to the SwitchingPWM block to drive the ideal closing
          switch or to the averaged switch network model. The duty
          cycle value begins at 0.1 and changes to 0.6 in the
          middle of the simulation. The effect of this change can
          be observed by plotting the output voltages:
        </p>
      
      
        <div class="figure">
          <p><img src="Images/BuckOpenResultsA.png"
                  alt="BuckOpenResultsA.png" />
          </p>
        </div>
      
        <p>
          The output voltage for both implementations is not
          exactly the same but it can be seen that the averaged
          model provides a very decent approximation. This is the
          case because both the switching and the averaged
          implementations are neglecting losses and because they
          are both correctly modelling CCM and DCM modes. The
          converter is operating in DCM in the first interval and
          in CCM in the second:
        </p>
      
      
        <div class="figure">
          <p><img src="Images/BuckOpenResultsB.png"
                  alt="BuckOpenResultsB.png" />
          </p>
        </div>
      
        <p>
          An interesting exercise to complete this example would
          be to build a controller to close the loop and study the
          system's behaviour.</p>
      
<p><span class="ModelicaBaseClass">Extends from Modelica.Icons.Example (Icon for runnable examples).</span></p>
<h3>Parameters</h3>
<table summary="Parameters" class="ModelicaTableParameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="PVSystems_Electrical.html#PVSystems.Electrical.CCM_DCM1"
>CCM_DCM1</a></td><td>sn</td><td>redeclare Electrical.CCM_DCM...</td><td>&nbsp;</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> BuckOpen <span class="ModelicaComment">&quot;Ideal open-loop buck converter&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DC(V=24);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rav(R=3);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> Lav(L=8e-6);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Capacitor"
>Modelica.Electrical.Analog.Basic.Capacitor</a> Cav(C=10e-6);
  <span class="ModelicaKeyword">replaceable </span><a href="PVSystems_Electrical.html#PVSystems.Electrical.CCM_DCM1"
>Electrical.CCM_DCM1</a> sn(Le=Lav.L, fs=PWM.fs)
                                                      <span class="ModelicaKeyword">constrainedby </span>
    PVSystems.Electrical.Interfaces.SwitchNetworkInterface;
  <a href="Modelica_Electrical_Analog_Ideal.html#Modelica.Electrical.Analog.Ideal.IdealClosingSwitch"
>Modelica.Electrical.Analog.Ideal.IdealClosingSwitch</a> sw;
  <a href="Modelica_Electrical_Analog_Ideal.html#Modelica.Electrical.Analog.Ideal.IdealDiode"
>Modelica.Electrical.Analog.Ideal.IdealDiode</a> dsw;
  <a href="PVSystems_Control.html#PVSystems.Control.SwitchingPWM"
>Control.SwitchingPWM</a> PWM(fs=1e5);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rsw(R=3);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> Lsw(L=8e-6);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Capacitor"
>Modelica.Electrical.Analog.Basic.Capacitor</a> Csw(C=10e-6);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gin;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gsw;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gav;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> duty(y=<span class="ModelicaKeyword">if </span>time &lt; 5e-4<span class="ModelicaKeyword"> then </span>0.1<span class="ModelicaKeyword"> else </span>0.6);
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(Cav.n, gav.p);
  <span class="ModelicaFunction">connect</span>(Rav.n, gav.p);
  <span class="ModelicaFunction">connect</span>(Lav.n, Rav.p);
  <span class="ModelicaFunction">connect</span>(Cav.p, Lav.n);
  <span class="ModelicaFunction">connect</span>(DC.p, sn.p1);
  <span class="ModelicaFunction">connect</span>(sn.p2, Lav.p);
  <span class="ModelicaFunction">connect</span>(sn.n2, gav.p);
  <span class="ModelicaFunction">connect</span>(sw.p, DC.p);
  <span class="ModelicaFunction">connect</span>(sw.n, dsw.n);
  <span class="ModelicaFunction">connect</span>(Lsw.n, Rsw.p);
  <span class="ModelicaFunction">connect</span>(Csw.p, Lsw.n);
  <span class="ModelicaFunction">connect</span>(Lsw.p, dsw.n);
  <span class="ModelicaFunction">connect</span>(Csw.n, Rsw.n);
  <span class="ModelicaFunction">connect</span>(dsw.p, gsw.p);
  <span class="ModelicaFunction">connect</span>(gsw.p, Csw.n);
  <span class="ModelicaFunction">connect</span>(gin.p, DC.n);
  <span class="ModelicaFunction">connect</span>(PWM.c1, sw.control);
  <span class="ModelicaFunction">connect</span>(PWM.vc, sn.d);
  <span class="ModelicaFunction">connect</span>(sn.n1, Lav.p);
  <span class="ModelicaFunction">connect</span>(duty.y, sn.d);
<span class="ModelicaKeyword">end </span>BuckOpen;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Inverter1phOpen<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.Inverter1phOpen" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.Inverter1phOpen"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.Inverter1phOpen</h2>
<p>
<span class="ModelicaDescription">Stand-alone 1-phase open-loop inverter with constant DC source</span>
<br>
<br><img src="PVSystems.Examples.Applic5b091e5d58711eb0hOpenD.png" alt="PVSystems.Examples.Application.Inverter1phOpen">
</p>
<h3>Information</h3>

        <p>
          This example presents two implementations of an open
          loop 1-phase inverter. The function of the inverter is
          to convert DC voltage and current into AC voltage and
          current. To keep things simple, a constant DC source is
          included on the DC side and an RL load is included on
          the AC side. Typically, inverters are placed inside a
          more complicated setup, which might require MPPT
          (Maximum Power Point Tracking) on the DC side when
          connected to a PV array and AC synchronization when
          connected to a grid on the AC side instead of just a
          simple passive load.
        </p>
      
        <p>
          Nevertheless, the example still showcases an interesting
          application. Upon running the simulation with the
          provided values, plotting the resistor voltages yields
          the following figure:
        </p>
      
      
        <div class="figure">
          <p><img src="Images/Inverter1phOpenResults.png"
                  alt="Inverter1phOpenResults.png" />
          </p>
        </div>
      
        <p>
          The AC is achieved with the inverter topology (called an
          H-bridge) as well as with the duty cycle sinusoidal
          modulation. Have a look at the duty cycle driving the
          SwitchingPWM block and compare it with the voltage drop
          in the resistor.
        </p>
      
        <p>
          Compare it with the voltage drop in the inductor. The
          voltage coming out of the inverter is actually a square
          wave and the inductor is providing some crude (but
          enough for some applications) filtering. Play around
          with the value of the inductor to see how it provides a
          better or worse filtering performance (decreasing or
          increasing the voltage and current ripple in the
          resistor, which in this example is assumed to be the
          load being fed). Since this is an open loop
          configuration, it will also change the peak value of the
          voltage drop in the resistor, as well as its phase.
        </p>
      
        <p>
          Importantly, see how the the average model provides a
          very good approximation for low frequencies. This kind
          of model won't be useful to study ripples and to
          evaluate the performance of different PWM modulations
          (sinusoidal modulation is being used in this example) or
          of different filter configurations, since those are
          concerned with the high frequencies in the system. On
          the other hand, the average models will be very useful
          to study controllers and to perform longer simulations
          since the simulation step doesn't need to be so small as
          to accurately represent the switching dynamics.</p>
      
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> Inverter1phOpen
  <span class="ModelicaComment">&quot;Stand-alone 1-phase open-loop inverter with constant DC source&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridgeSwitched"
>Electrical.Assemblies.HBridgeSwitched</a>
                                HBsw;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DCsw(V=580);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gsw;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rsw(R=1e-2);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> Lsw(L=1e-3);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Sine"
>Modelica.Blocks.Sources.Sine</a> duty(
    offset=0.5,
    freqHz=50,
    amplitude=0.05);
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridge"
>PVSystems.Electrical.Assemblies.HBridge</a> HBav;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rav(R=1e-2);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> Lav(L=1e-3);
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DCav(V=580);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gav;
  <a href="PVSystems_Control.html#PVSystems.Control.SwitchingPWM"
>Control.SwitchingPWM</a> switchingPWM(fs=3125);
  <a href="PVSystems_Control.html#PVSystems.Control.DeadTime"
>Control.DeadTime</a> deadTime;
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(DCsw.n, gsw.p);
  <span class="ModelicaFunction">connect</span>(HBsw.n1, DCsw.n);
  <span class="ModelicaFunction">connect</span>(HBsw.p1, DCsw.p);
  <span class="ModelicaFunction">connect</span>(HBsw.p2, Lsw.p);
  <span class="ModelicaFunction">connect</span>(HBsw.n2, Rsw.n);
  <span class="ModelicaFunction">connect</span>(Rsw.p, Lsw.n);
  <span class="ModelicaFunction">connect</span>(Rav.p, Lav.n);
  <span class="ModelicaFunction">connect</span>(HBav.p2, Lav.p);
  <span class="ModelicaFunction">connect</span>(Rav.n, HBav.n2);
  <span class="ModelicaFunction">connect</span>(HBav.d, duty.y);
  <span class="ModelicaFunction">connect</span>(DCav.n, gav.p);
  <span class="ModelicaFunction">connect</span>(DCav.p, HBav.p1);
  <span class="ModelicaFunction">connect</span>(DCav.n, HBav.n1);
  <span class="ModelicaFunction">connect</span>(deadTime.c1, HBsw.c1);
  <span class="ModelicaFunction">connect</span>(deadTime.c2, HBsw.c2);
  <span class="ModelicaFunction">connect</span>(switchingPWM.c1, deadTime.c);
  <span class="ModelicaFunction">connect</span>(switchingPWM.vc, duty.y);
<span class="ModelicaKeyword">end </span>Inverter1phOpen;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Inverter1phOpenSynch<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.Inverter1phOpenSynch" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.Inverter1phOpenSynch"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.Inverter1phOpenSynch</h2>
<p>
<span class="ModelicaDescription">Grid-tied 1-phase open-loop inverter with constant DC source</span>
<br>
<br><img src="PVSystems.Examples.Applic2937ae3ce5bdd63bSynchD.png" alt="PVSystems.Examples.Application.Inverter1phOpenSynch">
</p>
<h3>Information</h3>

      <p>
        This example goes a step further
        than <a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application.Inverter1phOpen"
>Inverter1phOpen</a>
        and includes grid synchronization. Typically this is the condition
        for inverters in real-life situations. Both switched and averaged
        implementations are presented for comparison purposes and it can be
        seen that they both provide very similar results (excluding the fact
        that high frequencies are left out in the averaged model).
      </p>


      <div class="figure">
        <p><img src="Images/Inverter1phOpenSynchResults.png"
                alt="Inverter1phOpenSynch_Plot.png" />
        </p>
      </div>

      <p>
        Since this is still open-loop and there's no in-quadrature
        separation, the value of the current can't comfortably be specified
        to be of a certain value. Since the RL load has almost equal real
        and imaginary parts, the current that is drawn from the inverter has
        a power factor different than one.
      </p>

      <p>
        A key value to pay attention to in this example is the gain that is
        placed in the <i>Add</i> block.
      </p>


      <div class="figure">
        <p><img src="Images/Inverter1phOpenSynchDialog.png"
                alt="Inverter1phOpenSynchDialog.png" />
        </p>
      </div>

      <p>
        It's initially set at 0.5. The value is expressed as 580/580/2 to
        highlight the fact that this gain should be normalized to the DC
        voltage value. Above that, over-modulation will occur and the output
        current of the inverter will become quite ugly. Play around with
        this value (using values between 0 and 0.5) to see how the output
        current of the inverter changes.
      </p>
      
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> Inverter1phOpenSynch
  <span class="ModelicaComment">&quot;Grid-tied 1-phase open-loop inverter with constant DC source&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridgeSwitched"
>Electrical.Assemblies.HBridgeSwitched</a>
                                HBsw;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DCsw(V=580);
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SineVoltage"
>Modelica.Electrical.Analog.Sources.SineVoltage</a> ACsw(freqHz=50, V=480);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> Lsw(L=1e-3);
  <a href="PVSystems_Control.html#PVSystems.Control.PLL"
>Control.PLL</a> pLL;
  <a href="Modelica_Blocks_Math.html#Modelica.Blocks.Math.Cos"
>Modelica.Blocks.Math.Cos</a> sin;
  <a href="Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> add(k2=1, k1=580/580/2);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> const(k=0.5);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rsw(R=1e-2);
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridge"
>PVSystems.Electrical.Assemblies.HBridge</a> HBav;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> Lav(L=1e-3);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rav(R=1e-2);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gsw;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> VacSense(y=ACsw.v);
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SineVoltage"
>Modelica.Electrical.Analog.Sources.SineVoltage</a> ACav(freqHz=50, V=480);
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DCav(V=580);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> gav;
  <a href="PVSystems_Control.html#PVSystems.Control.SwitchingPWM"
>Control.SwitchingPWM</a> switchingPWM(fs=3125);
  <a href="PVSystems_Control.html#PVSystems.Control.DeadTime"
>Control.DeadTime</a> deadTime;
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(pLL.theta, sin.u);
  <span class="ModelicaFunction">connect</span>(const.y, add.u2);
  <span class="ModelicaFunction">connect</span>(sin.y, add.u1);
  <span class="ModelicaFunction">connect</span>(VacSense.y, pLL.v);
  <span class="ModelicaFunction">connect</span>(ACav.p, Rav.n);
  <span class="ModelicaFunction">connect</span>(Rav.p, Lav.n);
  <span class="ModelicaFunction">connect</span>(HBav.p2, Lav.p);
  <span class="ModelicaFunction">connect</span>(HBav.n2, ACav.n);
  <span class="ModelicaFunction">connect</span>(ACsw.p, Rsw.n);
  <span class="ModelicaFunction">connect</span>(Rsw.p, Lsw.n);
  <span class="ModelicaFunction">connect</span>(HBsw.n2, ACsw.n);
  <span class="ModelicaFunction">connect</span>(HBsw.p2, Lsw.p);
  <span class="ModelicaFunction">connect</span>(DCav.n, gav.p);
  <span class="ModelicaFunction">connect</span>(DCsw.n, gsw.p);
  <span class="ModelicaFunction">connect</span>(DCsw.p, HBsw.p1);
  <span class="ModelicaFunction">connect</span>(DCsw.n, HBsw.n1);
  <span class="ModelicaFunction">connect</span>(DCav.n, HBav.n1);
  <span class="ModelicaFunction">connect</span>(DCav.p, HBav.p1);
  <span class="ModelicaFunction">connect</span>(add.y, HBav.d);
  <span class="ModelicaFunction">connect</span>(deadTime.c1, HBsw.c1);
  <span class="ModelicaFunction">connect</span>(deadTime.c2, HBsw.c2);
  <span class="ModelicaFunction">connect</span>(switchingPWM.c1, deadTime.c);
  <span class="ModelicaFunction">connect</span>(switchingPWM.vc, HBav.d);
<span class="ModelicaKeyword">end </span>Inverter1phOpenSynch;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Inverter1phClosed<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.Inverter1phClosed" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.Inverter1phClosed"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.Inverter1phClosed</h2>
<p>
<span class="ModelicaDescription">Stand-alone 1-phase closed-loop inverter with constant DC source</span>
<br>
<br><img src="PVSystems.Examples.Applic873290ebdda1b9a5losedD.png" alt="PVSystems.Examples.Application.Inverter1phClosed">
</p>
<h3>Information</h3>

        <p>
          This example explores a closed-loop inverter. No grid is
          present, which simplifies things. But, since the
          controller is implemented in the synchronous (dq)
          reference frame, a synchronization source needs to
          exist. This is implemented with the saw tooth generator,
          which emulates the output of the PLL.
        </p>
      
        <p>
          As can be seen in the following figure, one can now
          comfortably specify the setpoint for the output current
          of the inverter:
        </p>
      
      
        <div class="figure">
          <p><img src="Images/Inverter1phClosedResults.png"
                  alt="Inverter1phClosedResults.png" />
          </p>
        </div>
      
        <p>
          Having the posibility to separately control the current
          in each dq axis enables one to control the power factor
          (i.e. the phase lag between the voltage and the current)
          as well as the amplitude of the current.
        </p>
      
        <p>
          In this example, the equivalent synchronization signal
          is plotted to see this phase shift as the setpoints
          change. Notice how, when the q component of the current
          is 0, the d component is equal to the peak current.</p>
      
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> Inverter1phClosed
  <span class="ModelicaComment">&quot;Stand-alone 1-phase closed-loop inverter with constant DC source&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DC(V=580);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> ground;
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridge"
>PVSystems.Electrical.Assemblies.HBridge</a> HB;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> R(R=1e-2);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> L(L=1e-3);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Step"
>Modelica.Blocks.Sources.Step</a> iqSetpoint(height=141.4, startTime=0.3);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Step"
>Modelica.Blocks.Sources.Step</a> idSetpoint(
    height=141.4 - 200,
    offset=200,
    startTime=0.3);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.SawTooth"
>Modelica.Blocks.Sources.SawTooth</a> sawTooth(amplitude=2*Modelica.Constants.pi,
      period=0.02);
  <a href="PVSystems_Control_Assemblies.html#PVSystems.Control.Assemblies.Inverter1phCurrentController"
>Control.Assemblies.Inverter1phCurrentController</a> control;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> iacSense(y=L.i);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> vdcSense(y=DC.v);
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(DC.n, ground.p);
  <span class="ModelicaFunction">connect</span>(R.p, L.n);
  <span class="ModelicaFunction">connect</span>(HB.p1, DC.p);
  <span class="ModelicaFunction">connect</span>(HB.n1, DC.n);
  <span class="ModelicaFunction">connect</span>(HB.p2, L.p);
  <span class="ModelicaFunction">connect</span>(HB.n2, R.n);
  <span class="ModelicaFunction">connect</span>(sawTooth.y, control.theta);
  <span class="ModelicaFunction">connect</span>(control.d, HB.d);
  <span class="ModelicaFunction">connect</span>(iqSetpoint.y, control.ids);
  <span class="ModelicaFunction">connect</span>(idSetpoint.y, control.iqs);
  <span class="ModelicaFunction">connect</span>(iacSense.y, control.i);
  <span class="ModelicaFunction">connect</span>(vdcSense.y, control.vdc);
<span class="ModelicaKeyword">end </span>Inverter1phClosed;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Inverter1phClosedSynch<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.Inverter1phClosedSynch" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.Inverter1phClosedSynch"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.Inverter1phClosedSynch</h2>
<p>
<span class="ModelicaDescription">Grid-tied 1-phase closed-loop inverter with constant DC source</span>
<br>
<br><img src="PVSystems.Examples.Applic6f9dbe064eb67d7bSynchD.png" alt="PVSystems.Examples.Application.Inverter1phClosedSynch">
</p>
<h3>Information</h3>

          <p>
            This example includes a voltage source on the AC
            side. This will add the synchronization challenge for
            the controller: in order to provide adequate control of
            the output current, the duty cycle needs to be carefully
            in synch with the AC grid voltage.
          </p>
        
          <p>
            Plotting the current through the load, the dq setpoints,
            the grid voltage and the actual computed d value of the
            current yields the following graph:
          </p>
        
        
          <div class="figure">
            <p><img src="Images/Inverter1phClosedSynchResults.png"
                    alt="Inverter1phClosedSynchResults.png" />
            </p>
          </div>
        
          <p>
            After an initial period where the signals are reaching
            their steady-state values, the current successfully
            reaches the setpoint value. Since the q setpoint is
            equal to zero, the output current stays in phase with
            the grid voltage and the d setpoint value equals the
            peak current value.</p>
        
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> Inverter1phClosedSynch
  <span class="ModelicaComment">&quot;Grid-tied 1-phase closed-loop inverter with constant DC source&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.ConstantVoltage"
>Modelica.Electrical.Analog.Sources.ConstantVoltage</a> DC(V=580);
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SineVoltage"
>Modelica.Electrical.Analog.Sources.SineVoltage</a> AC(freqHz=50, V=480);
  <a href="PVSystems_Control.html#PVSystems.Control.PLL"
>Control.PLL</a> pll;
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridge"
>PVSystems.Electrical.Assemblies.HBridge</a> HB(d(start=0.5));
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> L(L=1e-3);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> R(R=1e-2);
  <a href="PVSystems_Control_Assemblies.html#PVSystems.Control.Assemblies.Inverter1phCurrentController"
>Control.Assemblies.Inverter1phCurrentController</a> control(d(start=0.5));
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> idSetpoint(k=400);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> iqSetpoint(k=0);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> ground;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> vacSense(y=AC.v);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> iacSense(y=AC.i);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> vdcSense(y=DC.v);
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(L.n, R.p);
  <span class="ModelicaFunction">connect</span>(HB.p2, L.p);
  <span class="ModelicaFunction">connect</span>(R.n, AC.p);
  <span class="ModelicaFunction">connect</span>(DC.p, HB.p1);
  <span class="ModelicaFunction">connect</span>(DC.n, HB.n1);
  <span class="ModelicaFunction">connect</span>(iqSetpoint.y, control.iqs);
  <span class="ModelicaFunction">connect</span>(idSetpoint.y, control.ids);
  <span class="ModelicaFunction">connect</span>(DC.n, ground.p);
  <span class="ModelicaFunction">connect</span>(AC.n, HB.n2);
  <span class="ModelicaFunction">connect</span>(control.d, HB.d);
  <span class="ModelicaFunction">connect</span>(iacSense.y, control.i);
  <span class="ModelicaFunction">connect</span>(pll.theta, control.theta);
  <span class="ModelicaFunction">connect</span>(vacSense.y, pll.v);
  <span class="ModelicaFunction">connect</span>(vdcSense.y, control.vdc);
<span class="ModelicaKeyword">end </span>Inverter1phClosedSynch;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PVInverter1ph<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.PVInverter1ph" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.PVInverter1ph"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.PVInverter1ph</h2>
<p>
<span class="ModelicaDescription">Stand-alone 1-phase closed-loop inverter with PV source</span>
<br>
<br><img src="PVSystems.Examples.Applicfdc05875fa2b1b30er1phD.png" alt="PVSystems.Examples.Application.PVInverter1ph">
</p>
<h3>Information</h3>

              <p>
                This example adds a PV array to the DC side. To start as
                simple as possible, the AC side is just a passive RL
                load. A general controller for this kind of setup is
                devised and packaged
                as <a href="PVSystems_Control_Assemblies.html#PVSystems.Control.Assemblies.Inverter1phCompleteController"
>Inverter1phCompleteController</a>. This
                block accepts no input because it's assumed that the
                controller will try to extract the maximum active power
                from the PV array. Internally, the q current setpoint is
                set to zero.
              </p>
            
              <p>
                Plotting the DC bus voltage and the output current
                confirms shows that this is in fact how the controller
                is behaving:
              </p>
            
            
              <div class="figure">
                <p><img src="Images/PVInverter1phResultsA.png"
                        alt="PVInverter1phResultsA.png" />
                </p>
              </div>
            
              <p>
                The maximum power point is achieved by indirectly
                balancing the difference between the power delivered by
                the PV array and the power dumped on to the grid. As the
                maximum power point is being reached, the difference
                tends to zero:
              </p>
            
            
              <div class="figure">
                <p><img src="Images/PVInverter1phResultsB.png"
                        alt="PVInverter1phResultsB.png" /></p>
              </div>
            
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> PVInverter1ph <span class="ModelicaComment">&quot;Stand-alone 1-phase closed-loop inverter with PV source&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="PVSystems_Electrical.html#PVSystems.Electrical.PVArray"
>Electrical.PVArray</a> PV(v(start=450));
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> Gn(k=1000);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> Tn(k=298.15);
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridge"
>PVSystems.Electrical.Assemblies.HBridge</a> Inverter;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> L(L=1e-3);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> R(R=1e-2);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Capacitor"
>Modelica.Electrical.Analog.Basic.Capacitor</a> Cdc(               C=5e-1, v(start=
          10));
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rdc(R=1e-3, v(start=30));
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> ground;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Cosine"
>Modelica.Blocks.Sources.Cosine</a> vacEmulation(freqHz=50);
  <a href="PVSystems_Control_Assemblies.html#PVSystems.Control.Assemblies.Inverter1phCompleteController"
>Control.Assemblies.Inverter1phCompleteController</a> controller(
    fline=50,
    ik=0.1,
    iT=0.01,
    vk=10,
    vT=0.5,
    iqMax=10,
    vdcMax=71,
    idMax=10);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> iacSense(y=L.i);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> idcSense(y=-PV.i);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> vdcSense(y=PV.v);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> DCPower(y=-PV.i*PV.v);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> ACPower(y=R.i*R.v);
  <a href="Modelica_Blocks_Math.html#Modelica.Blocks.Math.Mean"
>Modelica.Blocks.Math.Mean</a> meanACPower(f=50);
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(Gn.y, PV.G);
  <span class="ModelicaFunction">connect</span>(Tn.y, PV.T);
  <span class="ModelicaFunction">connect</span>(Cdc.p, Inverter.p1);
  <span class="ModelicaFunction">connect</span>(L.n, R.p);
  <span class="ModelicaFunction">connect</span>(Cdc.n, Inverter.n1);
  <span class="ModelicaFunction">connect</span>(PV.p, Rdc.p);
  <span class="ModelicaFunction">connect</span>(Cdc.n, ground.p);
  <span class="ModelicaFunction">connect</span>(PV.n, ground.p);
  <span class="ModelicaFunction">connect</span>(Rdc.n, Cdc.p);
  <span class="ModelicaFunction">connect</span>(Inverter.p2, L.p);
  <span class="ModelicaFunction">connect</span>(Inverter.n2, R.n);
  <span class="ModelicaFunction">connect</span>(idcSense.y, controller.idc);
  <span class="ModelicaFunction">connect</span>(vdcSense.y, controller.vdc);
  <span class="ModelicaFunction">connect</span>(vacEmulation.y, controller.vac);
  <span class="ModelicaFunction">connect</span>(iacSense.y, controller.iac);
  <span class="ModelicaFunction">connect</span>(ACPower.y, meanACPower.u);
  <span class="ModelicaFunction">connect</span>(controller.d, Inverter.d);
<span class="ModelicaKeyword">end </span>PVInverter1ph;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PVInverter1phSynch<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.PVInverter1phSynch" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.PVInverter1phSynch"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.PVInverter1phSynch</h2>
<p>
<span class="ModelicaDescription">Grid-tied 1-phase closed-loop inverter with PV source</span>
<br>
<br><img src="PVSystems.Examples.Applic6bebcf046759623eSynchD.png" alt="PVSystems.Examples.Application.PVInverter1phSynch">
</p>
<h3>Information</h3>

        <p>
          This example represents a simple yet complete grid-tied
          PV inverter system. A long simulation is performed so as
          to visualize the time evolution of the MPPT control,
          which is necessarily much slower than the output current
          control. This long simulation time is manageable because
          an averaged switch model is being used, which means that
          the simulation can have longer time steps.
        </p>
      
        <p>
          This evolution can be observed by plotting the DC bus
          voltage as well as the input and output power to the
          inverter:
        </p>
      
      
        <div class="figure">
          <p><img src="Images/PVInverter1phSynchResultsA.png"
                  alt="PVInverter1phSynchResultsA.png" />
          </p>
        </div>
      
        <p>
          As expected, the power factor of the output power is 1
          (all active power), having the output current in synch
          with the grid voltage:
        </p>
      
      
        <div class="figure">
          <p><img src="Images/PVInverter1phSynchResultsB.png"
                  alt="PVInverter1phSynchResultsB.png" /></p>
        </div>
      
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> PVInverter1phSynch
  <span class="ModelicaComment">&quot;Grid-tied 1-phase closed-loop inverter with PV source&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="PVSystems_Electrical.html#PVSystems.Electrical.PVArray"
>Electrical.PVArray</a> PV(v(start=450));
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> Gn(k=1000);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> Tn(k=298.15);
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.HBridge"
>PVSystems.Electrical.Assemblies.HBridge</a> Inverter;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SineVoltage"
>Modelica.Electrical.Analog.Sources.SineVoltage</a> AC(freqHz=50, V=15);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Inductor"
>Modelica.Electrical.Analog.Basic.Inductor</a> L(L=1e-3);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> R(R=1e-2);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Capacitor"
>Modelica.Electrical.Analog.Basic.Capacitor</a> Cdc(v(start=32.8), C=0.5);
  <a href="PVSystems_Control_Assemblies.html#PVSystems.Control.Assemblies.Inverter1phCompleteController"
>Control.Assemblies.Inverter1phCompleteController</a> Controller(
    ik=0.1,
    iT=0.01,
    fline=50,
    vk=10,
    vT=0.5,
    idMax=20,
    iqMax=20,
    vdcMax=50);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rdc(R=1e-3, v(start=30));
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> ground;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> vdcSense(y=PV.v);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> idcSense(y=-PV.i);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> iacSense(y=AC.i);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> vacSense(y=AC.v);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> DCPower(y=-PV.i*PV.v);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> ACPower(y=AC.v*AC.i);
  <a href="Modelica_Blocks_Math.html#Modelica.Blocks.Math.Mean"
>Modelica.Blocks.Math.Mean</a> meanACPower(f=50);
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(Gn.y, PV.G);
  <span class="ModelicaFunction">connect</span>(Tn.y, PV.T);
  <span class="ModelicaFunction">connect</span>(Cdc.p, Inverter.p1);
  <span class="ModelicaFunction">connect</span>(R.n, AC.p);
  <span class="ModelicaFunction">connect</span>(L.n, R.p);
  <span class="ModelicaFunction">connect</span>(Cdc.n, Inverter.n1);
  <span class="ModelicaFunction">connect</span>(Inverter.p2, L.p);
  <span class="ModelicaFunction">connect</span>(Inverter.n2, AC.n);
  <span class="ModelicaFunction">connect</span>(Rdc.n, Cdc.p);
  <span class="ModelicaFunction">connect</span>(PV.p, Rdc.p);
  <span class="ModelicaFunction">connect</span>(PV.n, Cdc.n);
  <span class="ModelicaFunction">connect</span>(PV.n, ground.p);
  <span class="ModelicaFunction">connect</span>(Controller.d, Inverter.d);
  <span class="ModelicaFunction">connect</span>(vdcSense.y, Controller.vdc);
  <span class="ModelicaFunction">connect</span>(idcSense.y, Controller.idc);
  <span class="ModelicaFunction">connect</span>(iacSense.y, Controller.iac);
  <span class="ModelicaFunction">connect</span>(vacSense.y, Controller.vac);
  <span class="ModelicaFunction">connect</span>(ACPower.y, meanACPower.u);
<span class="ModelicaKeyword">end </span>PVInverter1phSynch;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE USBBatteryConverter<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="PVSystems.Examples.Application.BuckOpenI.png" alt="PVSystems.Examples.Application.USBBatteryConverter" align="right" style="border: 1px solid" width="80" height="80">
<a name="PVSystems.Examples.Application.USBBatteryConverter"></a><a href="PVSystems_Examples_Application.html#PVSystems.Examples.Application"
>PVSystems.Examples.Application</a>.USBBatteryConverter</h2>
<p>
<span class="ModelicaDescription">Bidirectional converter for USB battery interface</span>
<br>
<br><img src="PVSystems.Examples.Applica703c01c50956d05erterD.png" alt="PVSystems.Examples.Application.USBBatteryConverter">
</p>
<h3>Information</h3>

          <p>
            A battery, simulated with a controlled voltage source in
            series with a small resistance, is interfaced with a USB
            device, simulated with a resistive load. The converter
            is a component included in
            the <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies"
>Electrical.Assemblies</a>
            package.
          </p>
        
          <p>
            This example is borrowed
            from <a href="PVSystems_UsersGuide_References.html#PVSystems.UsersGuide.References.EMA16"
>EMA16</a>. The
            application is not that related with photovoltaics, but
            provides a good showcase of the power electronics models
            in this library. The converter is specified to have
            three operating modes:
          </p>
        
          <ul class="org-ul">
            <li>Battery voltage 12.6V, USB voltage 5+/-0.1V at 2A,
              converter supplies bus.
            </li>
            <li>Battery voltage 9.6V, USB voltage 20+/-0.1V at 3A,
              converter supplies bus.
            </li>
            <li>Battery voltage 11.1V, USB voltage 20V, bus supplies
              60W to charge battery.
            </li>
          </ul>
        
          <p>
            An efficient solution to these step-down and
            bidirectional step-up requirements is a non-inverting
            buck-boost converter with bi-directional switches
            operated in a buck/boost modal fashion (i.e. the boost
            switches are disabled while in buck mode and vice
            versa). A possible solution to these requirements using
            this topology is expressed through the parametrization
            of <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.CPMBidirectionalBuckBoost"
>CPMBidirectionalBuckBoost</a>:
          </p>
        
        
          <div class="figure">
            <p><img src="Images/USBBatteryConverterParameters.png"
                    alt="USBBatteryConverterParameters.png" />
            </p>
          </div>
        
          <p>
            This converter model includes both the electrical and
            control components of a Current-Peak Mode controlled
            modal non-inverting buck-boost. The default stop time is
            set at 20 seconds. Running the simulation and plotting
            the output voltage and current produces the following
            result:
          </p>
        
        
          <div class="figure">
            <p><img src="Images/USBBatteryConverterResults.png"
                    alt="USBBatteryConverterResults.png" /></p>
          </div>
        
<p><span class="ModelicaBaseClass">Extends from <a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</span></p>
<h3>Modelica definition</h3>
<div class="modelica"><span class="ModelicaKeyword">model</span> USBBatteryConverter <span class="ModelicaComment">&quot;Bidirectional converter for USB battery interface&quot;</span>
  <span class="ModelicaKeyword">extends </span><a href="Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;
  <a href="PVSystems_Electrical_Assemblies.html#PVSystems.Electrical.Assemblies.CPMBidirectionalBuckBoost"
>Electrical.Assemblies.CPMBidirectionalBuckBoost</a> conv(
    Cin=10e-6,
    Cout=88e-6,
    L=10e-6,
    Rf=1,
    fs=200e3,
    RL=8e-3,
    Va_buck=0.5,
    Va_boost=1,
    vCin_ini=12.6,
    vCout_ini=5,
    iL_ini=2);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> boostVs(y=20);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> buckVs(y=5);
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Ground"
>Modelica.Electrical.Analog.Basic.Ground</a> ground;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.Resistor"
>Modelica.Electrical.Analog.Basic.Resistor</a> Rbatt(R=50e-3);
  <a href="Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.LimPID"
>Modelica.Blocks.Continuous.LimPID</a> buckPI(
    k=10,
    controllerType=Modelica.Blocks.Types.SimpleController.PI,
    Ti=1,
    yMin=0,
    yMax=8);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> voutSense(y=conv.v2);
  <a href="Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.LimPID"
>Modelica.Blocks.Continuous.LimPID</a> boostPI(
    k=10,
    controllerType=Modelica.Blocks.Types.SimpleController.PI,
    Ti=1,
    yMin=0,
    yMax=8);
  <a href="Modelica_Blocks_Logical.html#Modelica.Blocks.Logical.Switch"
>Modelica.Blocks.Logical.Switch</a> modeSelector;
  <a href="Modelica_Electrical_Analog_Basic.html#Modelica.Electrical.Analog.Basic.VariableResistor"
>Modelica.Electrical.Analog.Basic.VariableResistor</a> Rload;
  <a href="Modelica_Electrical_Analog_Sources.html#Modelica.Electrical.Analog.Sources.SignalVoltage"
>Modelica.Electrical.Analog.Sources.SignalVoltage</a> Vbatt;
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Ramp"
>Modelica.Blocks.Sources.Ramp</a> VbattSignal(
    duration=0.1,
    startTime=10,
    offset=12.6,
    height=9.6 - 12.6);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Ramp"
>Modelica.Blocks.Sources.Ramp</a> RloadSignal(
    duration=0.1,
    startTime=10,
    offset=2.5,
    height=6.67 - 2.5);
  <a href="Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.BooleanExpression"
>Modelica.Blocks.Sources.BooleanExpression</a> modeCommand(y=time &gt; 10);
<span class="ModelicaKeyword">equation </span>
  <span class="ModelicaFunction">connect</span>(Rbatt.n, conv.p1);
  <span class="ModelicaFunction">connect</span>(buckVs.y, buckPI.u_s);
  <span class="ModelicaFunction">connect</span>(voutSense.y, buckPI.u_m);
  <span class="ModelicaFunction">connect</span>(boostVs.y, boostPI.u_s);
  <span class="ModelicaFunction">connect</span>(conv.n2, ground.p);
  <span class="ModelicaFunction">connect</span>(voutSense.y, boostPI.u_m);
  <span class="ModelicaFunction">connect</span>(modeSelector.y, conv.vc);
  <span class="ModelicaFunction">connect</span>(boostPI.y, modeSelector.u1);
  <span class="ModelicaFunction">connect</span>(buckPI.y, modeSelector.u3);
  <span class="ModelicaFunction">connect</span>(Vbatt.p, Rbatt.p);
  <span class="ModelicaFunction">connect</span>(Vbatt.n, conv.n1);
  <span class="ModelicaFunction">connect</span>(ground.p, Rload.n);
  <span class="ModelicaFunction">connect</span>(Rload.p, conv.p2);
  <span class="ModelicaFunction">connect</span>(VbattSignal.y, Vbatt.v);
  <span class="ModelicaFunction">connect</span>(RloadSignal.y, Rload.R);
  <span class="ModelicaFunction">connect</span>(modeCommand.y, modeSelector.u2);
  <span class="ModelicaFunction">connect</span>(modeCommand.y, conv.mode);
<span class="ModelicaKeyword">end </span>USBBatteryConverter;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Sep 11 16:11:42 2017.
</address>
</body>
</html>
